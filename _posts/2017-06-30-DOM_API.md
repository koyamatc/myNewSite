---
layout: post
title: DOM APIs
date: 2017-06-22 00:00:00 +900
categories: post edx javascript
description:
  edx's course by W3C.
  Introductory course designed to understand 
  the basic concepts of JavaScript.  
---

-------

#### Introduction
##### The DOM standard - exploring the DOM of a document

__Introduction__
When a user clicks on a link or enters a URL in the address of your Web browser, it downloads the page’s HTML text and builds up a model of the document’s structure called the DOM (Document Object Model). This model is used to render the HTML page on the screen.

The DOM is a standard  that describes how a document must be manipulated. It defines a “language- and platform neutral interface”. So, every browser offers the same JavaScript DOM API.

The DOM API is a programming interface the JavaScript programmer can use to modify the HTML content or the CSS style of HTML elements on the fly.

The DOM API provides the document object as a structured object, a group of nodes represented as a tree. We saw this in Module 1 when we revised the basic principles of HTML .

The document object also exposes a large set of methods to access and manipulate the structured document. Through the DOM, look for nodes (html elements that compose the page), move nodes, delete nodes, modify nodes (attributes, content), and also handle their associated events.

In JavaScript, the DOM is accessible through the property document of the global object window. We rarely manipulate the window object directly as it is implicit: window.document is the same as document. 

So by using this object, we can access and manipulate our page from JavaScript as a structured document.

##### Reminder from Module 1: HTML and the DOM
Elements' are the pieces themselves, i.e., a paragraph, a header, and even the body are elements. Most elements can contain other elements - for example, the body element would contain header elements, paragraph elements, in fact pretty much all of the visible elements of the Document Object Model (developers call it the "DOM").

Let's take, for example, a simplified version of the last HTML code we showed you:
{% highlight html linenos %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Your first HTML page</title>
        <meta charset="utf-8">
    </head>
    <body>
        <h1>My home page</h1>
        <p>Hi! Welcome to my Home Page! My name is Michel Buffa,
        I'm a professor at the University of Nice, in France,
        and I'm also the author of two MOOCS about HTML5 on
        W3Cx.
        </p>
    </body>
</html>
{% endhighlight %}

#### A warning about the DOM API
The DOM and the DOM API can be cumbersome and complicated. There are many methods and properties for manipulating the DOM tree, that are not "very JavaScript". There are historical reasons for this: the DOM wasn’t designed exclusively for JavaScript. Rather, it tries to define a language-neutral interface that can be used in other systems as well — not just HTML but also XML, which is a generic data format with an HTML-like syntax.

HTML5 made some additions that are not in the DOM API but which greatly help the JavaScript programmer (we'll see this in a minute with the "selector API", for example).

So we've decided to focus on only 20% of the DOM API and on the selector API (for selecting elements in the DOM). These are the most useful parts and it will give you enough knowledge to solve nearly every problem where you need to manipulate the DOM.

#### Accessing HTML elements

##### 1 - With the selector API (recommended)
Extract from HTML5 selectors API – It’s like a Swiss Army Knife for the DOM : "One of the many reasons for the success of JavaScript libraries like jQuery and Prototype, on top of their easing the pain of cross-browser development was how they made working with the DOM far less painful than it had previously been, and indeed how it was with the standard DOM. Being able to use arbitrary CSS selector notation to get matching elements from a document made the standard DOM methods seem antiquated, or at the very least, far too much like hard work.

Luckily, the standards and browser developers took notice. The W3C developed the Selectors API, a way of easily accessing elements in the DOM using standard CSS selector concepts, and browser developers have baked these into all modern browsers, way back to IE8."

__The querySelector(CSSSelector) and querySelectorAll(CSSSelector) methods__
Ah... these methods owe a lot to jQuery! They introduce a way to use CSS selectors (including CSS3 selectors) for requesting the DOM, like jQuery introduced ages ago.

Any CSS  selector can be passed as a parameter for these methods.

<ul class="collection">
    <li class="collection-item">
    While querySelector(selector) will return the first element in the DOM that matches the selector (and you will be able to work with it directly),
    </li>
    <li class="collection-item">
    querySelectorAll(selector) returns a collection of HTML elements corresponding to all elements matching the selector. To process the results, it will be necessary to loop over each of the elements in the collection.    
    </li>
</ul>


##### 2 - With the DOM API (old fashioned)

These methods are from the DOM API and can all be replaced by the querySelector and querySelectorAll methods that we've discussed. They are still used in many JavaScript applications, and are very simple to understand.

From the document we can access the elements composing our web page in a few ways:
<ul class="collection">
    <li class="collection-header">
    <strong>
    document.getElementById(identifier) returns the element which has the id “identifier”.
    </strong></li>
    <li class="collection-item">
        <ul class="collection">
            <li class="collection-item">
            This is equivalent to document.querySelector("#identifier'); (just add a # before the id when using a CSS selector). </li>
            <li class="collection-item">
            Example: var elm = document.getElementById('myDiv'); is equivalent to document.querySelector('#myDiv');</li>
        </ul>
    </li>
    <li class="collection-header">
    <strong>
    document.getElementsByTagName(tagName) returns a list of elements which are named “tagName”.
    </strong></li>
    <li class="collection-item">
        <ul class="collection">
            <li class="collection-item">
            This is equivalent to document.querySelectorAll(tagName);</li>
            <li class="collection-item">
            Example: var list = document.getElementByTagName('img'); is equivalent to document.querySelector('img');</li>
        </ul>
    </li>
    <li class="collection-header">
    <strong>
    document.getElementsByClassName(className) returns a list of elements which have the class “className”.
    </strong></li>
    <li class="collection-item">
        <ul class="collection">
            <li class="collection-item">
            This is equivalent to document.querySelectorAll('.className'); </li>
            <li class="collection-item">
            Example: var list = document.getElementByClassName('important'); is equivalent to document.querySelector('.important'); (just add a '.' before the class name when using a CSS selector).</li>
        </ul>
    </li>
</ul>

Notice that identifier, tagName and className must be of type String. 

#### Changing the style of selected HTML elements
##### The style attribute: how to modify an HTML element's CSS properties from JavaScript
The most common way to modify the CSS style of one of several elements you selected using the DOM or Selector API, is to use the style attribute.

Typical use:
{% highligt javascrit linenos %}
// select the paragraph with id = "paragraph1"
var p = document.querySelector('#paragraph1');
 
// change its color
p.style.color = 'red';
{% endhighlight %}

Warning: with the style attribute, you can modify (or read) any CSS property, but be careful: the syntax changes a little due to the fact that in JavaScript the "-" is a math operator, while in CSS it is used to separate properties made of multiple words, such as background-color.

When using such properties from JavaScript, the rule is simple:

<ul class="collection">
    <li class="collection-item">
    1. Remove the "-" sign,
    </li>
    <li class="collection-item">
    2. Capitalize the word after the "-" sign!
    </li>
</ul>
Simple, isn't it?

Examples:

<ul class="collection">
    <li class="collection-item">
    text-align becomes style.testAlign
    </li>
    <li class="collection-item">
    margin-left becomes style.marginLeft
    </li>
    <li class="collection-item">
    etc.
    </li>
</ul>

The most useful CSS properties (we do recommend that you follow the W3Cx courses CSS basics, CSS and HTML5 fundamentals from W3Cx to learn more about CSS):
<ul class="collection">
    <li class="collection-item">
    color: changing the color of the text content of selected element(s),
    </li>
    <li class="collection-item">
    background-color: same but this time the background color,
    </li>
    <li class="collection-item">
    margin and padding properties (external and internal margins), including their variants: margin-left, margin-top, margin-right, margin-bottom, also padding-left, etc.
    </li>
    <li class="collection-item">
    border and border-radius: change the border, type (plain, dashed), color, thickness, rounded corners etc.
    </li>
    <li class="collection-item">
    box-shadow to add shadows to selected elements, 
    </li>
    <li class="collection-item">
    font, font-style: font characters and style (italic, bold, plain)
    </li>
    <li class="collection-item">
    text-align (centered, etc.)
    </li>
</ul>

##### Using the ClassList interface to change more than one CSS property simultaneously
Until now, to manipulate CSS classes of an HTML element was a bit complex, both for verifying the presence of a class name in an element, and for adding or removing classes associated with a given element.

The ClassList interface simplifies it all by acting as a container object and by providing a set of methods to manipulate its content.

The classList property applies to an HTML element, and returns a collection of class names:
{% highlight javascript linenos %}
var elem= document.querySelector("#id1");
 
var allClasses = elem.classList;
{% endhighlight %}

__The classList API__

The list of methods usable on a classList object are add(), remove(), toggle() and contains().
{% highlight javascript linenos %}
// By default, start without a class in the div: <div class=""/>
// Set "foo" as the class by adding it to the classList
div.classList.add('foo'); // now <div class="foo"/>
// Check that the classList contains the class "foo"
div.classList.contains('foo'); // returns true
// Remove the class "foo" from the list
div.classList.remove('foo'); // now <div class=""/>
// Check if classList contains the class "foo"
div.classList.contains('foo'); // returns false: "foo" is gone
// Check if class contains the class "foo",
// If it does, "foo" is removed, if it doesn't, it's added
div.classList.toggle('foo'); // class set to <div class="foo"/>
div.classList.toggle('foo'); // class set to <div class=""/>
{% endhighlight %}


This is a variation of an example from a previous section. This time, when the &lt;input type="checkbox"> elements have been checked, in order to give the parent &lt;li> a background color, a border, and to change the text color, we use a CSS class named "checked":

CSS code:
{% highlight css linenos %}
.checked {
    border: 2px dashed #000;
    background-color: green;
    color:yellow;
}
{% endhighlight %}
... and the classList.add(CSS_class) and classList.remove(CSS_class) methods on the &lt;li> elements:

JavaScript code:
{% highlight javascript linenos %}
function displayListOfCheckedItems() {
  // all inputs that have been checked
  var listOfSelectedValues="";
  var list = document.querySelectorAll("#fruits input:checked");
  list.forEach(function(elm) {
    listOfSelectedValues += elm.value + " ";
    // get the li parent of the current selected input
    var liParent = elm.parentNode;
    // add the CSS class .checked
    liParent.classList.add("checked");
  });
  document.body.append("You selected: " + listOfSelectedValues);
}
 
function reset() {
  var list = document.querySelectorAll("#fruits input");
  list.forEach(function(elm) {
    // uncheck
    elm.checked = false;
    // remove CSS decoration
    var liParent = elm.parentNode;
    liParent.classList.remove("checked");
  });
}
{% endhighlight %}